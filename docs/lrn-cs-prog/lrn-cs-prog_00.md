# 前言

C#是一种通用的、多范式的编程语言，结合了面向对象、命令式、泛型、函数式、声明式和动态编程。在发布后不久，C#就成为开发人员编写各种类型应用程序的首选之一。虽然它不是唯一针对 CLI 的语言（其他语言包括 VB.NET 和 F#），但它是编写桌面、Web、云和移动平台的.NET 应用程序的首选语言。

多年来，这种语言逐渐而稳定地发展。尽管最初它是一种面向对象的编程语言，但新版本已经将这种语言开放到了新的范式，比如泛型、函数式和动态编程。新的语言特性和更简洁的语法也定期添加进来。随着它作为.NET 编译器平台（也称为 Roslyn）的开源项目发布，这是一组用于 C#和 VB.NET 的编译器和代码分析 API，这种语言已经进入了一个新的开放时代，社区深度参与了语言的发展。

当前版本的语言被称为 C# 8。这是在 2019 年 9 月发布的，适用于.NET Core 3.0，并需要 Visual Studio 2019 16.3 或更新版本。C# 8 也可以与.NET Framework 一起使用，尽管并非所有功能都可用。这是因为它们需要运行时更改，这是微软不愿意做的事情，因为他们打算不再投资于.NET Framework（除了长期支持），并将.NET Core 转变为用于定位所有平台和类型应用程序的唯一框架。这个框架将简单地称为.NET。

这本书旨在帮助你从零开始学习这种语言，并最终掌握它的多范式编程方面。我们从非常基础的东西开始：数据类型、语句和其他构件。然后我们继续讲解面向对象的概念，比如类、接口、继承和多态。我们涵盖了泛型、函数式编程和 LINQ，反射和动态编程，以及更高级的主题，比如资源管理、模式匹配、并发和异步编程、错误处理和序列化。在书的最后，我们特别关注了 C# 8 中引入的新特性。最后，但同样重要的是，我们讨论了单元测试以及如何为你的 C#代码编写单元测试。在每一章的结尾，我们都会提供一系列问题，帮助你评估你在该章节中学到了什么。

这本书包含了许多代码片段，旨在帮助你轻松理解和学习所有的语言特性。所有这些代码都可以在附带的源代码中找到。你需要使用 Visual Studio 或 Visual Studio Code 来尝试它们。或者，你可以使用在线编译器，这种情况下的首选是[`sharplab.io/`](https://sharplab.io/)。

# 这本书适合谁？

如果你是一个热情的程序员，想要学习 C#，那么这本书适合你。如果你想开始学习编程，并且想要用 C#和.NET 来做到这一点，你也会发现这本书很有价值。然而，我们假设你对编程概念有一些基本的了解，比如什么是编译器，什么是类和方法等等。另一方面，如果你是一名经验丰富的 C#程序员，但想要了解 C# 8 的最新特性，或者如何使用.NET Core 并从.NET Framework 迁移，这本书对你也很有用。

# 这本书涵盖了什么

*第一章*, *从 C#的基本构件开始*，介绍了这种语言的历史，以及它与公共语言基础设施和.NET Framework 的关系，同时介绍了今天使用的.NET 框架系列。最后，你将学习有关程序集的知识，如何在 Visual Studio 中创建项目，以及如何用 C#编写一个 Hello World 程序。

第二章《数据类型和运算符》带您了解语言的基本元素，包括内置数据类型、变量和常量、引用和值类型、可空类型和数组类型，以及类型转换和内置运算符。

第三章《控制语句和异常》深入探讨了如何编写选择语句和循环，并简要介绍了处理异常。

第四章《理解各种用户定义类型》提供了关于类、字段、属性、方法、构造函数、如何向方法传递参数、访问修饰符以及与类相关的其他方面的信息。在接近结尾时，您将了解结构以及它们与类的比较，以及枚举。

第五章《C#中的面向对象编程》延续了前一章所建立的基础，教会您面向对象编程的核心支柱，以及如何使用 C#语言特性来实现它们，如接口、虚拟成员、方法重载等。

第六章《泛型》涵盖了 C#中泛型编程的所有方面，并教会您如何编写泛型类型和方法，以及如何为类型参数使用约束。

第七章《集合》介绍了通常在编写 C#程序时使用的.NET 基类库中的通用集合。该章节以概述在多线程场景中使用的并发集合结束。

第八章《高级主题》包含各种更高级的特性，如委托和事件、元组、扩展方法、模式匹配和正则表达式。

第九章《资源管理》解释了垃圾收集器的工作原理以及您应该如何确定性地处理资源。此外，在本章中，您将学习如何使用平台调用服务进行系统或一般的本机 API 调用，以及如何编写不安全的代码。

第十章《Lambda、LINQ 和函数式编程》概述了函数式编程概念以及与 C#中的 lambda 表达式相关的细节。您将学习如何使用语言集成查询（或 LINQ）统一查询各种数据源。在章节的结尾，我们涵盖了几个典型的函数式编程概念：部分函数应用、柯里化、闭包、幺半群和单子，以及它们在 C#中的工作原理。

第十一章《反射和动态编程》教会您反射服务是什么，以及如何使用它们编写可扩展的应用程序，如何动态加载程序集并执行代码，如何使用属性，以及如何使用动态语言运行时和动态类型与动态语言进行交互。

第十二章《多线程和异步编程》深入研究了线程、任务和同步机制，并揭示了用于在 C#中编写异步程序的 async-await 模式的细节。

第十三章《文件、流和序列化》解释了如何处理路径、文件和目录，以及如何使用流从各种存储选项（如文件和内存）读取和写入数据。在本章的第二部分，您将了解使用 XML 和 JSON 进行数据序列化。

第十四章，错误处理，是在第三章引入的关于异常处理的概念的基础上构建的，控制语句和异常，并教会你异常的内部工作原理以及异常处理与错误处理的区别。您将学习有关调试和监视的宝贵信息，以及处理异常的最佳实践。

第十五章，C# 8 的新特性，详细介绍了 C# 8 中引入的所有新语言特性，包括可空引用类型，异步流，范围和索引，模式匹配以及接口成员的默认实现。

第十六章，C#在.NET Core 3 中的应用，教会您如何使用.NET CLI 构建.NET Core 应用程序，如何针对 Linux 进行开发，.NET Standard 是什么以及它如何帮助应用程序设计，如何使用 NuGet 包，以及如何将.NET Framework 应用程序迁移到.NET Core。

第十七章，单元测试，涵盖了单元测试，微软用于测试 C#代码的工具，如何使用 Visual Studio 创建单元测试项目，以及如何编写单元测试和数据驱动的单元测试。

# 为了充分利用本书

这是一本涵盖 C#的书，从其基本构件到其最高级功能。本书适用于想要学习 C#的人。因此，我们不希望您具有任何关于该语言的先前知识。但是，我们希望您对编程概念有一些基本了解，比如编译器是什么，编译时和运行时的区别，堆栈和堆的区别等。

本书中的所有代码示例都是使用 C# 8 和现代编程风格（如使用表达式主体成员，插值字符串，本地函数等）编写的。所有这些示例与本书一起提供，项目针对.NET Core 3.1。

以下表格列出了运行这些示例所需的软件和平台要求：

![](img/Table.jpg)

要运行源代码，您需要 Visual Studio 2019 16.3 或更新版本的任何版本，或者 Visual Studio Code。大多数示例也可以使用在线编译器进行测试。如果您更喜欢这个选项，我们建议您使用[`sharplab.io/`](https://sharplab.io/)。

如果您使用的是本书的数字版本，我们建议您自己输入代码或通过 GitHub 存储库访问代码（链接在下一节中提供）。这样做将帮助您避免与复制/粘贴代码相关的任何潜在错误。

# 下载示例代码文件

您可以从[www.packt.com](http://packt.com)的帐户中下载本书的示例代码文件。如果您在其他地方购买了本书，可以访问[www.packtpub.com/support](https://www.packtpub.com/support)注册并直接将文件发送到您的邮箱。

您可以按照以下步骤下载代码文件：

1.  在[www.packt.com](http://packt.com)上登录或注册。

1.  选择**支持**选项卡。

1.  单击**代码下载**。

1.  在**搜索**框中输入书名，然后按照屏幕上的说明操作。

下载文件后，请确保使用最新版本的解压缩软件解压缩文件夹：

+   Windows 上的 WinRAR/7-Zip

+   Mac 上的 Zipeg/iZip/UnRarX

+   Linux 上的 7-Zip/PeaZip

该书的代码包也托管在 GitHub 上，网址为[`github.com/PacktPublishing/Learn-C-Sharp-Programming`](https://github.com/PacktPublishing/Learn-C-Sharp-Programming)。如果代码有更新，将在现有的 GitHub 存储库上进行更新。

我们还有来自我们丰富书籍和视频目录的其他代码包，网址为 https://github.com/PacktPublishing/。去看看吧！

# 实战代码

本书的代码演示视频可以在[`bit.ly/2VaAls9`](https://bit.ly/2VaAls9)上观看。

# 下载彩色图像

我们还提供了一个 PDF 文件，其中包含本书中使用的屏幕截图/图表的彩色图像。您可以在这里下载：https://static.packt-cdn.com/downloads/9781789805864_ColorImages.pdf。

# 使用的约定

本书中使用了许多文本约定。

`文本中的代码`：表示文本中的代码词，数据库表名，文件夹名，文件名，文件扩展名，路径名，虚拟 URL，用户输入和 Twitter 用户名。这是一个例子：“在这个例子中，我们创建了一个`Employee`类，其中包含三个字段，用于表示员工的 ID，名和姓。”

代码块设置如下：

```cs
class Employee
{
    public int    EmployeeId;
    public string FirstName;
    public string LastName;
}
```

当我们希望引起您对代码块的特定部分的注意时，相关的行或项目将以粗体显示：

```cs
public struct Vector
{
    public float x;
    public float y;
    private readonly float SquaredRo => (x * x) + (y * y);
    public readonly float GetLengthRo() => MathF.Sqrt(SquaredRo);
    public float GetLength() => MathF.Sqrt(SquaredRo);
}
```

任何命令行输入或输出都将按以下方式编写：

```cs
cd HelloSolution
dotnet new console -o Hello
dotnet sln add Hello
```

**粗体**：表示一个新术语，一个重要单词，或者您在屏幕上看到的单词。例如，菜单或对话框中的单词会以这种方式出现在文本中。这是一个例子：“创建新项目时，选择**Console App (.NET Core)**。”

提示或重要说明

看起来像这样。
