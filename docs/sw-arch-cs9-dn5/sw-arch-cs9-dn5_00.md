# 前言

本书涵盖了现代基于云和分布式软件架构中涉及的最常见设计模式和框架。它通过提供实际的现实场景，讨论了何时以及如何使用每种模式。本书还介绍了 DevOps、微服务、Kubernetes、持续集成和云计算等技术和流程，以便您可以开发并交付给客户最佳的软件解决方案。

本书将帮助您了解客户想要的产品。它将指导您在开发过程中解决可能遇到的最大问题。它还涵盖了在云环境中管理应用程序时需要遵循的注意事项，以及您需要遵循的做和不做。您将了解不同的架构方法，如分层架构、面向服务的架构、微服务、单页应用程序和云架构，并了解如何将它们应用于特定的业务需求。

最后，您将使用 Azure 在远程环境或云中部署代码。本书中的所有概念都将通过实际的实际用例来解释，其中设计原则在创建安全和健壮的应用程序时起到关键作用。通过本书，您将能够开发和交付高度可扩展和安全的企业级应用程序，满足最终客户的业务需求。

值得一提的是，本书不仅涵盖了软件架构师在开发 C#和.NET Core 解决方案时应遵循的最佳实践，还讨论了我们需要掌握的所有环境，以便根据最新趋势开发软件产品。

这第二版在代码和解释方面得到了改进，并且根据 C# 9 和.Net 5 提供的新机会进行了调整。我们添加了去年出现的所有新框架和技术，如 gRPC 和 Blazor，并在专门的章节中更详细地描述了 Kubernetes。

# 这本书是为谁写的

这本书适用于任何希望提高与 C#相关的 Azure 解决方案知识的软件架构师。它还适用于渴望成为架构师或希望使用.NET 堆栈构建企业应用程序的工程师和高级开发人员。需要具备 C#和.NET 的经验。

# 本书涵盖了什么

第一章《理解软件架构的重要性》解释了软件架构的基础知识。本章将为您提供正确的思维方式来面对客户需求，然后选择合适的工具、模式和框架。

第二章《非功能需求》指导您在应用程序开发的重要阶段，即收集和考虑应用程序必须满足的所有约束和目标，如可伸缩性、可用性、弹性、性能、多线程、互操作性和安全性。

第三章《使用 Azure DevOps 记录需求》描述了记录需求、错误和应用程序其他信息的技术。虽然大部分概念是通用的，但本章重点介绍了 Azure DevOps 和 GitHub 的使用。

第四章《选择最佳基于云的解决方案》为您提供了云中可用工具和资源以及 Microsoft Azure 的广泛概述。在这里，您将学习如何搜索合适的工具和资源，以及如何配置它们来满足您的需求。

第五章，将微服务架构应用于企业应用程序，提供了微服务和 Docker 容器的广泛概述。在这里，您将了解基于微服务的架构如何利用云提供的所有机会，并了解如何使用微服务在云中实现灵活性、高吞吐量和可靠性。您将学习如何使用容器和 Docker 在架构中混合不同的技术，以及使您的软件平台独立。

第六章，Azure Service Fabric，描述了微软特定的微服务编排器 Azure Service Fabric。在这里，您将实现一个简单的基于微服务的应用程序。

第七章，Azure Kubernetes Service，描述了 Kubernetes 的 Azure 实现，它是微服务编排的事实标准。在这里，您将在 Kubernetes 上打包和部署微服务应用程序。

第八章，使用 C#与数据交互-Entity Framework Core，详细解释了您的应用程序如何借助对象关系映射（ORM）以及特别是 Entity Framework Core 5.0 与各种存储引擎交互。

第九章，如何在云中选择数据存储，描述了云中和 Microsoft Azure 中可用的主要存储引擎。在这里，您将学习如何选择最佳的存储引擎以实现所需的读/写并行性以及如何配置它们。

第十章，使用 Azure Functions，描述了计算的无服务器模型以及如何在 Azure 云中使用它。在这里，您将学习如何在需要运行某些计算时分配云资源，从而仅支付实际计算时间。

第十一章，设计模式和.NET 5 实现，描述了常见的软件模式，并提供了.NET 5 的示例。在这里，您将了解模式的重要性以及使用它们的最佳实践。

第十二章，理解软件解决方案中的不同领域，描述了现代领域驱动设计软件生产方法，如何使用它来应对需要多个知识领域的复杂应用程序，以及如何利用基于云和微服务的架构。

第十三章，使用 C# 9 实现代码重用，描述了在.NET 5 应用程序中最大化代码重用的模式和最佳实践，以及代码重构的重要性。

第十四章，使用.NET Core 应用服务导向架构，描述了服务导向架构，它使您能够将应用程序的功能公开为 Web 或私有网络上的端点，以便用户可以通过各种类型的客户端与它们交互。在这里，您将学习如何使用 ASP.NET Core 和 gRPC 实现面向服务的架构端点，并如何使用现有的 OpenAPI 包自行记录它们。

第十五章，介绍 ASP.NET Core MVC，详细描述了 ASP.NET Core 框架。在这里，您将学习如何基于模型-视图-控制器（MVC）模式实现 Web 应用程序，以及如何根据领域驱动设计的规定组织它们，该设计在第十二章“理解软件解决方案中的不同领域”中有描述。

第十六章，Blazor WebAssembly，描述了利用 WebAssembly 在用户浏览器中运行.NET 的新 Blazor 框架。在这里，您将学习如何使用 C#实现单页应用程序。

第十七章，C# 9 编码最佳实践，描述了在使用 C# 9 开发.NET 5 应用程序时应遵循的最佳实践。

第十八章，使用单元测试用例和 TDD 测试您的代码，描述了如何测试您的应用程序。在这里，您将学习如何使用 xUnit 测试.NET Core 应用程序，以及如何轻松地开发和维护满足您规范的代码，借助测试驱动设计的帮助。

*第十九章*，*使用工具编写更好的代码*，描述了评估软件质量的度量标准，以及如何借助 Visual Studio 中包含的所有工具来衡量它们。

*第二十章*，*理解 DevOps 原则*，描述了 DevOps 软件开发和维护方法论的基础。在这里，您将学习如何组织应用程序的持续集成/持续交付周期。它还描述了如何自动化整个部署过程，从在源代码库中创建新版本，经过各种测试和批准步骤，到在实际生产环境中部署应用程序的最终部署。在这里，您将学习如何使用 Azure Pipelines 和 GitHub Actions 来自动化整个部署过程。

*第二十一章*，*应用 CI 场景的挑战*，补充了对 DevOps 的描述，介绍了持续集成场景。

*第二十二章*，*功能测试的自动化*，专门讲述了自动功能测试 - 也就是自动验证整个应用程序版本是否符合约定的功能规格的测试。在这里，您将学习如何使用自动化工具模拟用户操作，以及如何与 xUnit 一起使用这些工具编写功能测试。

# 充分利用本书

+   本书涵盖了许多主题。请将其视为您可能需要在不同情况下多次查看的指南。

+   不要忘记安装 Visual Studio Community 2019 或更高版本。

+   确保您理解 C# .NET 原则。

## 下载示例代码文件

该书的代码包托管在 GitHub 上，网址为[`github.com/PacktPublishing/Software-Architecture-with-C-9-and-.NET-5`](https://github.com/PacktPublishing/Software-Architecture-with-C-9-and-.NET-5)。我们还有其他书籍和视频的代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)上找到。请查看！

## 下载彩色图片

我们还提供了一个 PDF 文件，其中包含本书中使用的屏幕截图/图表的彩色图片。您可以在这里下载：[`static.packt-cdn.com/downloads/9781800566040_ColorImages.pdf`](https://static.packt-cdn.com/downloads/9781800566040_ColorImages.pdf)。

## 使用的约定

本书中使用了许多文本约定。

`CodeInText`：表示文本中的代码词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 句柄。例如：“当您调用`sb.ToString()`获取最终结果时，它们只会在最终字符串中复制一次。”

代码块设置如下：

```cs
[Fact]
public void Test1()
{
    var myInstanceToTest = new ClassToTest();
    Assert.Equal(5, myInstanceToTest.MethodToTest(1));
} 
```

任何命令行输入或输出都是这样写的：

```cs
kubectl create -f myClusterConfiguration.yaml 
```

**粗体**：表示新术语、重要单词或屏幕上看到的单词，例如菜单或对话框中的单词，也会在文本中出现。例如：“在**解决方案资源管理器**中，右键单击即可选择**发布...**”。

警告或重要提示是这样的。

提示和技巧是这样的。

# 联系我们

我们随时欢迎读者的反馈。

**一般反馈**：发送电子邮件至`feedback@packtpub.com`，并在主题中提及书名。如果您对本书的任何方面有疑问，请发送电子邮件至`questions@packtpub.com`。

**勘误**：尽管我们已经尽最大努力确保内容的准确性，但错误确实会发生。如果您在本书中发现错误，我们将不胜感激地接受您的报告。请访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，选择您的书，点击勘误提交表格链接，并输入详细信息。

盗版：如果您在互联网上发现我们作品的任何形式的非法副本，我们将不胜感激，如果您能向我们提供位置地址或网站名称。请通过`copyright@packtpub.com`与我们联系，并附上材料链接。

如果您有兴趣成为作者：如果您在某个专业领域有专长，并且有兴趣撰写或为一本书作出贡献，请访问[`authors.packtpub.com`](http://authors.packtpub.com)。

## 评论

请留下评论。当您阅读并使用了这本书之后，为什么不在购买它的网站上留下评论呢？潜在的读者可以看到并使用您的客观意见来做出购买决定，我们在 Packt 可以了解您对我们产品的看法，我们的作者也可以看到您对他们书籍的反馈。谢谢！

有关 Packt 的更多信息，请访问[packtpub.com](http://packtpub.com)。
